###############################################################################
#                                                                             #
# IAR C/C++ Compiler V8.10.3.10338/W32 for 8051         24/Oct/2016  22:06:35 #
# Copyright 2004-2011 IAR Systems AB.                                         #
#                                                                             #
#    Core               =  plain                                              #
#    Code model         =  banked                                             #
#    Data model         =  large                                              #
#    Calling convention =  xdata reentrant                                    #
#    Constant location  =  data_rom                                           #
#    Dptr setup         =  1,16                                               #
#    Source file        =  C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\Source\zcl_samplesw.c     #
#    Command line       =  -f C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\ #
#                          HomeAutomation\SampleSwitch\CC2530DB\..\..\..\Tool #
#                          s\CC2530DB\f8wRouter.cfg (-DCPU32MHZ               #
#                          -DROOT=__near_func -DMAC_CFG_APP_PENDING_QUEUE=TRU #
#                          E -DMAC_CFG_TX_DATA_MAX=5 -DMAC_CFG_TX_MAX=8       #
#                          -DMAC_CFG_RX_MAX=5 -DRTR_NWK) -f                   #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\Tools\C #
#                          C2530DB\f8wConfig.cfg (-DZIGBEEPRO -DSECURE=0      #
#                          -DZG_SECURE_DYNAMIC=0 -DREFLECTOR                  #
#                          -DDEFAULT_CHANLIST=0x00000800                      #
#                          -DZDAPP_CONFIG_PAN_ID=0xFFF2                       #
#                          -DNWK_START_DELAY=100 -DEXTENDED_JOINING_RANDOM_MA #
#                          SK=0x007F -DBEACON_REQUEST_DELAY=100               #
#                          -DBEACON_REQ_DELAY_MASK=0x00FF                     #
#                          -DLINK_STATUS_JITTER_MASK=0x007F                   #
#                          -DROUTE_EXPIRY_TIME=30 -DAPSC_ACK_WAIT_DURATION_PO #
#                          LLED=3000 -DNWK_INDIRECT_MSG_TIMEOUT=7             #
#                          -DMAX_RREQ_ENTRIES=8 -DAPSC_MAX_FRAME_RETRIES=3    #
#                          -DNWK_MAX_DATA_RETRIES=2                           #
#                          -DMAX_POLL_FAILURE_RETRIES=2 -DMAX_BCAST=9         #
#                          -DAPS_MAX_GROUPS=16 -DMAX_RTG_ENTRIES=40           #
#                          -DNWK_MAX_BINDING_ENTRIES=4                        #
#                          -DMAX_BINDING_CLUSTER_IDS=4 "-DDEFAULT_KEY={0x01,  #
#                          0x03, 0x05, 0x07, 0x09, 0x0B, 0x0D, 0x0F, 0x00,    #
#                          0x02, 0x04, 0x06, 0x08, 0x0A, 0x0C, 0x0D}"         #
#                          -DMAC_MAX_FRAME_SIZE=116                           #
#                          -DZDNWKMGR_MIN_TRANSMISSIONS=20 "-DCONST=const     #
#                          __code" -DGENERIC=__generic                        #
#                          -DRFD_RCVC_ALWAYS_ON=FALSE -DPOLL_RATE=1000        #
#                          -DQUEUED_POLL_RATE=100 -DRESPONSE_POLL_RATE=100    #
#                          -DREJOIN_POLL_RATE=440) -f                         #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\Tools\C #
#                          C2530DB\f8wZCL.cfg (-DZCL_READ -DZCL_WRITE         #
#                          -DZCL_BASIC -DZCL_IDENTIFY -DZCL_ON_OFF            #
#                          -DZCL_KEY_ESTABLISH -DZCL_KEY_ESTABLISHMENT_KEY_GE #
#                          NERATE_TIMEOUT=4 -DZCL_KEY_ESTABLISHMENT_MAC_GENER #
#                          ATE_TIMEOUT=10 -DZCL_KEY_ESTABLISHMENT_EKEY_GENERA #
#                          TE_TIMEOUT=10 -DZCL_LOAD_CONTROL                   #
#                          -DZCL_SIMPLE_METERING -DZCL_PRICING -DZCL_MESSAGE  #
#                          -DZCL_TUNNELING -DZCL_TOU) -DZCL_DEVICE_MGMT       #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\Source\zcl_samplesw.c -D  #
#                          ZTOOL_P1 -D MT_TASK -D MT_APP_FUNC -D MT_SYS_FUNC  #
#                          -D MT_ZDO_FUNC -D LCD_SUPPORTED=DEBUG -lC          #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\RouterEB\List\   #
#                          -lA C:\Users\xiang\Desktop\ZBStudy\Projects\zstack #
#                          \HomeAutomation\SampleSwitch\CC2530DB\RouterEB\Lis #
#                          t\ --diag_suppress Pe001,Pa010 -o                  #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\RouterEB\Obj\    #
#                          -e --no_code_motion --debug --core=plain           #
#                          --dptr=16,1 --data_model=large                     #
#                          --code_model=banked --calling_convention=xdata_ree #
#                          ntrant --place_constants=data_rom                  #
#                          --nr_virtual_regs 16 -I C:\Users\xiang\Desktop\ZBS #
#                          tudy\Projects\zstack\HomeAutomation\SampleSwitch\C #
#                          C2530DB\ -I C:\Users\xiang\Desktop\ZBStudy\Project #
#                          s\zstack\HomeAutomation\SampleSwitch\CC2530DB\..\S #
#                          ource\ -I C:\Users\xiang\Desktop\ZBStudy\Projects\ #
#                          zstack\HomeAutomation\SampleSwitch\CC2530DB\..\..\ #
#                          Source\ -I C:\Users\xiang\Desktop\ZBStudy\Projects #
#                          \zstack\HomeAutomation\SampleSwitch\CC2530DB\..\.. #
#                          \..\ZMain\TI2530DB\ -I C:\Users\xiang\Desktop\ZBSt #
#                          udy\Projects\zstack\HomeAutomation\SampleSwitch\CC #
#                          2530DB\..\..\..\..\..\Components\hal\include\ -I   #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\hal\target\CC2530EB\ -I                  #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\mac\include\ -I                          #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\mac\high_level\ -I                       #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\mac\low_level\srf04\ -I                  #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\mac\low_level\srf04\single_chip\ -I      #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\mt\ -I C:\Users\xiang\Desktop\ZBStudy\Pr #
#                          ojects\zstack\HomeAutomation\SampleSwitch\CC2530DB #
#                          \..\..\..\..\..\Components\osal\include\ -I        #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\services\saddr\ -I                       #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\services\sdata\ -I                       #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\stack\af\ -I C:\Users\xiang\Desktop\ZBSt #
#                          udy\Projects\zstack\HomeAutomation\SampleSwitch\CC #
#                          2530DB\..\..\..\..\..\Components\stack\nwk\ -I     #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\stack\sapi\ -I                           #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\stack\sec\ -I C:\Users\xiang\Desktop\ZBS #
#                          tudy\Projects\zstack\HomeAutomation\SampleSwitch\C #
#                          C2530DB\..\..\..\..\..\Components\stack\sys\ -I    #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\stack\zcl\ -I C:\Users\xiang\Desktop\ZBS #
#                          tudy\Projects\zstack\HomeAutomation\SampleSwitch\C #
#                          C2530DB\..\..\..\..\..\Components\stack\zdo\ -I    #
#                          C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\..\..\..\..\..\C #
#                          omponents\zmac\ -I C:\Users\xiang\Desktop\ZBStudy\ #
#                          Projects\zstack\HomeAutomation\SampleSwitch\CC2530 #
#                          DB\..\..\..\..\..\Components\zmac\f8w\ -Ohz        #
#                          --require_prototypes                               #
#    List file          =  C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\RouterEB\List\zc #
#                          l_samplesw.lst                                     #
#    Object file        =  C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\Hom #
#                          eAutomation\SampleSwitch\CC2530DB\RouterEB\Obj\zcl #
#                          _samplesw.r51                                      #
#                                                                             #
#                                                                             #
###############################################################################

C:\Users\xiang\Desktop\ZBStudy\Projects\zstack\HomeAutomation\SampleSwitch\Source\zcl_samplesw.c
      1          /**************************************************************************************************
      2            Filename:       zcl_samplesw.c
      3            Revised:        $Date: 2009-03-18 15:56:27 -0700 (Wed, 18 Mar 2009) $
      4            Revision:       $Revision: 19453 $
      5          
      6            Description:    Zigbee Cluster Library - sample device application.
      7          
      8          
      9            Copyright 2006-2009 Texas Instruments Incorporated. All rights reserved.
     10          
     11            IMPORTANT: Your use of this Software is limited to those specific rights
     12            granted under the terms of a software license agreement between the user
     13            who downloaded the software, his/her employer (which must be your employer)
     14            and Texas Instruments Incorporated (the "License").  You may not use this
     15            Software unless you agree to abide by the terms of the License. The License
     16            limits your use, and you acknowledge, that the Software may not be modified,
     17            copied or distributed unless embedded on a Texas Instruments microcontroller
     18            or used solely and exclusively in conjunction with a Texas Instruments radio
     19            frequency transceiver, which is integrated into your product.  Other than for
     20            the foregoing purpose, you may not use, reproduce, copy, prepare derivative
     21            works of, modify, distribute, perform, display or sell this Software and/or
     22            its documentation for any purpose.
     23          
     24            YOU FURTHER ACKNOWLEDGE AND AGREE THAT THE SOFTWARE AND DOCUMENTATION ARE
     25            PROVIDED “AS IS” WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESS OR IMPLIED,
     26            INCLUDING WITHOUT LIMITATION, ANY WARRANTY OF MERCHANTABILITY, TITLE,
     27            NON-INFRINGEMENT AND FITNESS FOR A PARTICULAR PURPOSE. IN NO EVENT SHALL
     28            TEXAS INSTRUMENTS OR ITS LICENSORS BE LIABLE OR OBLIGATED UNDER CONTRACT,
     29            NEGLIGENCE, STRICT LIABILITY, CONTRIBUTION, BREACH OF WARRANTY, OR OTHER
     30            LEGAL EQUITABLE THEORY ANY DIRECT OR INDIRECT DAMAGES OR EXPENSES
     31            INCLUDING BUT NOT LIMITED TO ANY INCIDENTAL, SPECIAL, INDIRECT, PUNITIVE
     32            OR CONSEQUENTIAL DAMAGES, LOST PROFITS OR LOST DATA, COST OF PROCUREMENT
     33            OF SUBSTITUTE GOODS, TECHNOLOGY, SERVICES, OR ANY CLAIMS BY THIRD PARTIES
     34            (INCLUDING BUT NOT LIMITED TO ANY DEFENSE THEREOF), OR OTHER SIMILAR COSTS.
     35          
     36            Should you have any questions regarding your right to use this Software,
     37            contact Texas Instruments Incorporated at www.TI.com.
     38          **************************************************************************************************/
     39          
     40          /*********************************************************************
     41            This device will be like an On/Off Switch device. This application
     42            is not intended to be a On/Off Switch device, but will use the device
     43            description to implement this sample code.
     44          *********************************************************************/
     45          
     46          /*********************************************************************
     47           * INCLUDES
     48           */
     49          #include "ZComDef.h"
     50          #include "OSAL.h"
     51          #include "AF.h"
     52          #include "ZDApp.h"
     53          #include "ZDObject.h"
     54          #include "ZDProfile.h"
     55          
     56          #include "zcl.h"
     57          #include "zcl_general.h"
     58          #include "zcl_ha.h"
     59          #include "zcl_samplesw.h"
     60          
     61          #include "onboard.h"
     62          
     63          /* HAL */
     64          #include "hal_lcd.h"
     65          #include "hal_led.h"
     66          #include "hal_key.h"
     67          
     68          
     69          /*********************************************************************
     70           * MACROS
     71           */
     72          
     73          /*********************************************************************
     74           * CONSTANTS
     75           */
     76          /*********************************************************************
     77           * TYPEDEFS
     78           */
     79          
     80          /*********************************************************************
     81           * GLOBAL VARIABLES
     82           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     83          byte zclSampleSw_TaskID;
   \                     zclSampleSw_TaskID:
   \   000000                DS 1
   \   000001                REQUIRE __INIT_XDATA_Z
     84          
     85          /*********************************************************************
     86           * GLOBAL FUNCTIONS
     87           */
     88          
     89          /*********************************************************************
     90           * LOCAL VARIABLES
     91           */

   \                                 In  segment XDATA_Z, align 1, keep-with-next
     92          static afAddrType_t zclSampleSw_DstAddr;
   \                     zclSampleSw_DstAddr:
   \   000000                DS 12
   \   00000C                REQUIRE __INIT_XDATA_Z
     93          
     94          #define ZCLSAMPLESW_BINDINGLIST       1

   \                                 In  segment XDATA_I, align 1, keep-with-next
     95          static cId_t bindingOutClusters[ZCLSAMPLESW_BINDINGLIST] =
   \                     bindingOutClusters:
   \   000000                DS 2
   \   000002                REQUIRE `?<Initializer for bindingOutClusters>`
   \   000002                REQUIRE __INIT_XDATA_I
     96          {
     97            ZCL_CLUSTER_ID_GEN_ON_OFF
     98          };
     99          
    100          // Test Endpoint to allow SYS_APP_MSGs

   \                                 In  segment XDATA_I, align 1, keep-with-next
    101          static endPointDesc_t sampleSw_TestEp =
   \                     sampleSw_TestEp:
   \   000000                DS 6
   \   000006                REQUIRE `?<Initializer for sampleSw_TestEp>`
   \   000006                REQUIRE __INIT_XDATA_I
    102          {
    103            20,                                 // Test endpoint
    104            &zclSampleSw_TaskID,
    105            (SimpleDescriptionFormat_t *)NULL,  // No Simple description for this test endpoint
    106            (afNetworkLatencyReq_t)0            // No Network Latency req
    107          };
    108          
    109          
    110          /*********************************************************************
    111           * LOCAL FUNCTIONS
    112           */
    113          static void zclSampleSw_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg );
    114          static void zclSampleSw_HandleKeys( byte shift, byte keys );
    115          static void zclSampleSw_BasicResetCB( void );
    116          static void zclSampleSw_IdentifyCB( zclIdentify_t *pCmd );
    117          static void zclSampleSw_IdentifyQueryRspCB(  zclIdentifyQueryRsp_t *pRsp );
    118          static void zclSampleSw_ProcessIdentifyTimeChange( void );
    119          
    120          // Functions to process ZCL Foundation incoming Command/Response messages
    121          static void zclSampleSw_ProcessIncomingMsg( zclIncomingMsg_t *msg );
    122          #ifdef ZCL_READ
    123          static uint8 zclSampleSw_ProcessInReadRspCmd( zclIncomingMsg_t *pInMsg );
    124          #endif
    125          #ifdef ZCL_WRITE
    126          static uint8 zclSampleSw_ProcessInWriteRspCmd( zclIncomingMsg_t *pInMsg );
    127          #endif
    128          static uint8 zclSampleSw_ProcessInDefaultRspCmd( zclIncomingMsg_t *pInMsg );
    129          #ifdef ZCL_DISCOVER
    130          static uint8 zclSampleSw_ProcessInDiscRspCmd( zclIncomingMsg_t *pInMsg );
    131          #endif
    132          
    133          /*********************************************************************
    134           * ZCL General Profile Callback table
    135           */

   \                                 In  segment XDATA_I, align 1, keep-with-next
    136          static zclGeneral_AppCallbacks_t zclSampleSw_CmdCallbacks =
   \                     zclSampleSw_CmdCallbacks:
   \   000000                DS 30
   \   00001E                REQUIRE `?<Initializer for zclSampleSw_CmdCallbacks>`
   \   00001E                REQUIRE __INIT_XDATA_I
    137          {
    138            zclSampleSw_BasicResetCB,     // Basic Cluster Reset command
    139            zclSampleSw_IdentifyCB,       // Identify command
    140            zclSampleSw_IdentifyQueryRspCB, // Identify Query Response command
    141            NULL,                         // On / Off cluster command - not needed.
    142            NULL,                         // Level Control Move to Level command
    143            NULL,                         // Level Control Move command
    144            NULL,                         // Level Control Step command
    145            NULL,                         // Group Response commands
    146            NULL,                         // Scene Store Request command
    147            NULL,                         // Scene Recall Request command
    148            NULL,                         // Scene Response commands
    149            NULL,                         // Alarm (Response) commands
    150            NULL,                         // RSSI Location commands
    151            NULL,                         // RSSI Location Response commands
    152          };
    153          
    154          
    155          /*********************************************************************
    156           * @fn          zclSampleSw_Init
    157           *
    158           * @brief       Initialization function for the zclGeneral layer.
    159           *
    160           * @param       none
    161           *
    162           * @return      none
    163           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    164          void zclSampleSw_Init( byte task_id )
   \                     zclSampleSw_Init:
    165          {
   \   000000   74F7         MOV     A,#-0x9
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 9
   \   000005                ; Auto size: 0
   \   000005   E9           MOV     A,R1
    166            zclSampleSw_TaskID = task_id;
   \   000006   90....       MOV     DPTR,#zclSampleSw_TaskID
   \   000009   F0           MOVX    @DPTR,A
    167          
    168            // Set destination address to indirect
    169            zclSampleSw_DstAddr.addrMode = (afAddrMode_t)AddrNotPresent;
   \   00000A   90....       MOV     DPTR,#zclSampleSw_DstAddr + 8
   \   00000D   E4           CLR     A
   \   00000E   F0           MOVX    @DPTR,A
    170            zclSampleSw_DstAddr.endPoint = 0;
   \   00000F   A3           INC     DPTR
   \   000010   F0           MOVX    @DPTR,A
    171            zclSampleSw_DstAddr.addr.shortAddr = 0;
   \   000011   90....       MOV     DPTR,#zclSampleSw_DstAddr
   \   000014   F0           MOVX    @DPTR,A
   \   000015   A3           INC     DPTR
   \   000016   F0           MOVX    @DPTR,A
    172          
    173            // This app is part of the Home Automation Profile
    174            zclHA_Init( &zclSampleSw_SimpleDesc );
   \   000017                ; Setup parameters for call to function zclHA_Init
   \   000017   7A..         MOV     R2,#zclSampleSw_SimpleDesc & 0xff
   \   000019   7B..         MOV     R3,#(zclSampleSw_SimpleDesc >> 8) & 0xff
   \   00001B   12....       LCALL   ??zclHA_Init?relay
    175          
    176            // Register the ZCL General Cluster Library callback functions
    177            zclGeneral_RegisterCmdCallbacks( SAMPLESW_ENDPOINT, &zclSampleSw_CmdCallbacks );
   \   00001E                ; Setup parameters for call to function zclGeneral_RegisterCmdCallbacks
   \   00001E   7A..         MOV     R2,#zclSampleSw_CmdCallbacks & 0xff
   \   000020   7B..         MOV     R3,#(zclSampleSw_CmdCallbacks >> 8) & 0xff
   \   000022   790C         MOV     R1,#0xc
   \   000024   12....       LCALL   ??zclGeneral_RegisterCmdCallbacks?relay
    178          
    179            // Register the application's attribute list
    180            zcl_registerAttrList( SAMPLESW_ENDPOINT, SAMPLESW_MAX_ATTRIBUTES, zclSampleSw_Attrs );
   \   000027                ; Setup parameters for call to function zcl_registerAttrList
   \   000027   7C..         MOV     R4,#zclSampleSw_Attrs & 0xff
   \   000029   7D..         MOV     R5,#(zclSampleSw_Attrs >> 8) & 0xff
   \   00002B   7A0B         MOV     R2,#0xb
   \   00002D   790C         MOV     R1,#0xc
   \   00002F   12....       LCALL   ??zcl_registerAttrList?relay
    181          
    182            // Register the Application to receive the unprocessed Foundation command/response messages
    183            zcl_registerForMsg( zclSampleSw_TaskID );
   \   000032                ; Setup parameters for call to function zcl_registerForMsg
   \   000032   90....       MOV     DPTR,#zclSampleSw_TaskID
   \   000035   E0           MOVX    A,@DPTR
   \   000036   F9           MOV     R1,A
   \   000037   12....       LCALL   ??zcl_registerForMsg?relay
    184          
    185            // Register for all key events - This app will handle all key events
    186            RegisterForKeys( zclSampleSw_TaskID );
   \   00003A                ; Setup parameters for call to function RegisterForKeys
   \   00003A   90....       MOV     DPTR,#zclSampleSw_TaskID
   \   00003D   E0           MOVX    A,@DPTR
   \   00003E   F9           MOV     R1,A
   \   00003F   12....       LCALL   ??RegisterForKeys?relay
    187          
    188            // Register for a test endpoint
    189            afRegister( &sampleSw_TestEp );
   \   000042                ; Setup parameters for call to function afRegister
   \   000042   7A..         MOV     R2,#sampleSw_TestEp & 0xff
   \   000044   7B..         MOV     R3,#(sampleSw_TestEp >> 8) & 0xff
   \   000046   12....       LCALL   ??afRegister?relay
    190          
    191            ZDO_RegisterForZDOMsg( zclSampleSw_TaskID, End_Device_Bind_rsp );
   \   000049                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000049   7A20         MOV     R2,#0x20
   \   00004B   7B80         MOV     R3,#-0x80
   \   00004D   90....       MOV     DPTR,#zclSampleSw_TaskID
   \   000050   E0           MOVX    A,@DPTR
   \   000051   F9           MOV     R1,A
   \   000052   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
    192            ZDO_RegisterForZDOMsg( zclSampleSw_TaskID, Match_Desc_rsp );
   \   000055                ; Setup parameters for call to function ZDO_RegisterForZDOMsg
   \   000055   7A06         MOV     R2,#0x6
   \   000057   7B80         MOV     R3,#-0x80
   \   000059   90....       MOV     DPTR,#zclSampleSw_TaskID
   \   00005C   E0           MOVX    A,@DPTR
   \   00005D   F9           MOV     R1,A
   \   00005E   12....       LCALL   ??ZDO_RegisterForZDOMsg?relay
    193          }
   \   000061   7F01         MOV     R7,#0x1
   \   000063   02....       LJMP    ?BANKED_LEAVE_XDATA
    194          
    195          /*********************************************************************
    196           * @fn          zclSample_event_loop
    197           *
    198           * @brief       Event Loop Processor for zclGeneral.
    199           *
    200           * @param       none
    201           *
    202           * @return      none
    203           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    204          uint16 zclSampleSw_event_loop( uint8 task_id, uint16 events )
   \                     zclSampleSw_event_loop:
    205          {
   \   000000   74F2         MOV     A,#-0xe
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 14
   \   000005                ; Auto size: 0
   \   000005   8A..         MOV     ?V0 + 0,R2
   \   000007   8B..         MOV     ?V0 + 1,R3
    206            afIncomingMSGPacket_t *MSGpkt;
    207            (void)task_id;  // Intentionally unreferenced parameter
    208          
    209            if ( events & SYS_EVENT_MSG )
   \   000009   EB           MOV     A,R3
   \   00000A   5480         ANL     A,#0x80
   \   00000C   7035         JNZ     ??zclSampleSw_event_loop_0
    210            {
    211              while ( (MSGpkt = (afIncomingMSGPacket_t *)osal_msg_receive( zclSampleSw_TaskID )) )
    212              {
    213                switch ( MSGpkt->hdr.event )
    214                {
    215                  case ZCL_INCOMING_MSG:
    216                    // Incoming ZCL Foundation command/response messages
    217                    zclSampleSw_ProcessIncomingMsg( (zclIncomingMsg_t *)MSGpkt );
    218                    break;
    219          
    220                  case ZDO_CB_MSG:
    221                    zclSampleSw_ProcessZDOMsgs( (zdoIncomingMsg_t *)MSGpkt );
    222                    break;
    223          
    224                  case KEY_CHANGE:
    225                    zclSampleSw_HandleKeys( ((keyChange_t *)MSGpkt)->state, ((keyChange_t *)MSGpkt)->keys );
    226                    break;
    227          
    228                  default:
    229                    break;
    230                }
    231          
    232                // Release the memory
    233                osal_msg_deallocate( (uint8 *)MSGpkt );
    234              }
    235          
    236              // return unprocessed events
    237              return (events ^ SYS_EVENT_MSG);
    238            }
    239          
    240            if ( events & SAMPLESW_IDENTIFY_TIMEOUT_EVT )
   \   00000E   EA           MOV     A,R2
   \   00000F   A2E0         MOV     C,0xE0 /* A   */.0
   \   000011   4003         JC      $+5
   \   000013   02....       LJMP    ??zclSampleSw_event_loop_1 & 0xFFFF
    241            {
    242              zclSampleSw_IdentifyTime = 10;
   \   000016   90....       MOV     DPTR,#zclSampleSw_IdentifyTime
   \   000019   740A         MOV     A,#0xa
   \   00001B   F0           MOVX    @DPTR,A
   \   00001C   A3           INC     DPTR
   \   00001D   E4           CLR     A
   \   00001E   F0           MOVX    @DPTR,A
    243              zclSampleSw_ProcessIdentifyTimeChange();
   \   00001F                ; Setup parameters for call to function zclSampleSw_ProcessIdentifyTimeChange
   \   00001F   12....       LCALL   ??zclSampleSw_ProcessIdentifyTimeChange?relay
    244          
    245              return ( events ^ SAMPLESW_IDENTIFY_TIMEOUT_EVT );
   \   000022   E5..         MOV     A,?V0 + 0
   \   000024   6401         XRL     A,#0x1
   \   000026   FA           MOV     R2,A
   \   000027   AB..         MOV     R3,?V0 + 1
   \   000029   02....       LJMP    ??zclSampleSw_event_loop_2 & 0xFFFF
    246            }
   \                     ??zclSampleSw_event_loop_3:
   \   00002C                ; Setup parameters for call to function zclSampleSw_HandleKeys
   \   00002C   A3           INC     DPTR
   \   00002D   A3           INC     DPTR
   \   00002E   A3           INC     DPTR
   \   00002F   E0           MOVX    A,@DPTR
   \   000030   FA           MOV     R2,A
   \   000031   8E82         MOV     DPL,R6
   \   000033   8F83         MOV     DPH,R7
   \   000035   A3           INC     DPTR
   \   000036   A3           INC     DPTR
   \   000037   E0           MOVX    A,@DPTR
   \   000038   F9           MOV     R1,A
   \   000039   12....       LCALL   ??zclSampleSw_HandleKeys?relay
   \                     ??zclSampleSw_event_loop_4:
   \   00003C                ; Setup parameters for call to function osal_msg_deallocate
   \   00003C   EE           MOV     A,R6
   \   00003D   FA           MOV     R2,A
   \   00003E   EF           MOV     A,R7
   \   00003F   FB           MOV     R3,A
   \   000040   12....       LCALL   ??osal_msg_deallocate?relay
   \                     ??zclSampleSw_event_loop_0:
   \   000043                ; Setup parameters for call to function osal_msg_receive
   \   000043   90....       MOV     DPTR,#zclSampleSw_TaskID
   \   000046   E0           MOVX    A,@DPTR
   \   000047   F9           MOV     R1,A
   \   000048   12....       LCALL   ??osal_msg_receive?relay
   \   00004B   8A..         MOV     ?V0 + 2,R2
   \   00004D   8B..         MOV     ?V0 + 3,R3
   \   00004F   AE..         MOV     R6,?V0 + 2
   \   000051   AF..         MOV     R7,?V0 + 3
   \   000053   EE           MOV     A,R6
   \   000054   4F           ORL     A,R7
   \   000055   7003         JNZ     $+5
   \   000057   02....       LJMP    ??zclSampleSw_event_loop_5 & 0xFFFF
   \   00005A   8E82         MOV     DPL,R6
   \   00005C   8F83         MOV     DPH,R7
   \   00005E   E0           MOVX    A,@DPTR
   \   00005F   24CC         ADD     A,#-0x34
   \   000061   600A         JZ      ??zclSampleSw_event_loop_6
   \   000063   2474         ADD     A,#0x74
   \   000065   60C5         JZ      ??zclSampleSw_event_loop_3
   \   000067   24ED         ADD     A,#-0x13
   \   000069   6042         JZ      ??zclSampleSw_event_loop_7
   \   00006B   80CF         SJMP    ??zclSampleSw_event_loop_4
   \                     ??zclSampleSw_event_loop_6:
   \   00006D   A3           INC     DPTR
   \   00006E   A3           INC     DPTR
   \   00006F   A3           INC     DPTR
   \   000070   A3           INC     DPTR
   \   000071   A3           INC     DPTR
   \   000072   A3           INC     DPTR
   \   000073   A3           INC     DPTR
   \   000074   E0           MOVX    A,@DPTR
   \   000075   14           DEC     A
   \   000076   6011         JZ      ??zclSampleSw_event_loop_8
   \   000078   24FD         ADD     A,#-0x3
   \   00007A   701A         JNZ     ??zclSampleSw_event_loop_9
   \   00007C   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_0:
   \   00007F   E0           MOVX    A,@DPTR
   \   000080   F8           MOV     R0,A
   \   000081   E9           MOV     A,R1
   \   000082   C3           CLR     C
   \   000083   98           SUBB    A,R0
   \   000084   5010         JNC     ??zclSampleSw_event_loop_9
   \   000086   09           INC     R1
   \   000087   80F6         SJMP    ??CrossCallReturnLabel_0
   \                     ??zclSampleSw_event_loop_8:
   \   000089   12....       LCALL   ?Subroutine1 & 0xFFFF
   \                     ??CrossCallReturnLabel_1:
   \   00008C   8001         SJMP    ??zclSampleSw_event_loop_10
   \                     ??zclSampleSw_event_loop_11:
   \   00008E   09           INC     R1
   \                     ??zclSampleSw_event_loop_10:
   \   00008F   E0           MOVX    A,@DPTR
   \   000090   F8           MOV     R0,A
   \   000091   E9           MOV     A,R1
   \   000092   C3           CLR     C
   \   000093   98           SUBB    A,R0
   \   000094   40F8         JC      ??zclSampleSw_event_loop_11
   \                     ??zclSampleSw_event_loop_9:
   \   000096   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_2:
   \   000099   F8           MOV     R0,A
   \   00009A   A3           INC     DPTR
   \   00009B   E0           MOVX    A,@DPTR
   \   00009C   F9           MOV     R1,A
   \   00009D   E8           MOV     A,R0
   \   00009E   49           ORL     A,R1
   \   00009F   609B         JZ      ??zclSampleSw_event_loop_4
   \   0000A1                ; Setup parameters for call to function osal_mem_free
   \   0000A1   12....       LCALL   ?Subroutine2 & 0xFFFF
   \                     ??CrossCallReturnLabel_3:
   \   0000A4   FA           MOV     R2,A
   \   0000A5   A3           INC     DPTR
   \   0000A6   E0           MOVX    A,@DPTR
   \   0000A7   FB           MOV     R3,A
   \                     ??zclSampleSw_event_loop_12:
   \   0000A8   12....       LCALL   ??osal_mem_free?relay
   \   0000AB   808F         SJMP    ??zclSampleSw_event_loop_4
   \                     ??zclSampleSw_event_loop_7:
   \   0000AD   EE           MOV     A,R6
   \   0000AE   240C         ADD     A,#0xc
   \   0000B0   F582         MOV     DPL,A
   \   0000B2   EF           MOV     A,R7
   \   0000B3   3400         ADDC    A,#0x0
   \   0000B5   F583         MOV     DPH,A
   \   0000B7   E0           MOVX    A,@DPTR
   \   0000B8   F5..         MOV     ?V0 + 2,A
   \   0000BA   A3           INC     DPTR
   \   0000BB   E0           MOVX    A,@DPTR
   \   0000BC   F5..         MOV     ?V0 + 3,A
   \   0000BE   78..         MOV     R0,#?V0 + 2
   \   0000C0   12....       LCALL   ?US_SWITCH_SPARSE
   \                     `?<Jumptable for zclSampleSw_event_loop>_0`:
   \   0000C3   0000         DW        0
   \   0000C5   0200         DW        2
   \   0000C7   0680         DW        32774
   \   0000C9   ....         DW        ??zclSampleSw_event_loop_13
   \   0000CB   2080         DW        32800
   \   0000CD   ....         DW        ??zclSampleSw_event_loop_14
   \   0000CF   ....         DW        ??zclSampleSw_event_loop_4
   \                     ??zclSampleSw_event_loop_13:
   \   0000D1                ; Setup parameters for call to function ZDO_ParseEPListRsp
   \   0000D1   12....       LCALL   ??ZDO_ParseEPListRsp?relay
   \   0000D4   8A..         MOV     ?V0 + 2,R2
   \   0000D6   8B..         MOV     ?V0 + 3,R3
   \   0000D8   EA           MOV     A,R2
   \   0000D9   45..         ORL     A,?V0 + 3
   \   0000DB   7003         JNZ     $+5
   \   0000DD   02....       LJMP    ??zclSampleSw_event_loop_4 & 0xFFFF
   \   0000E0   8A82         MOV     DPL,R2
   \   0000E2   8B83         MOV     DPH,R3
   \   0000E4   E0           MOVX    A,@DPTR
   \   0000E5   7032         JNZ     ??zclSampleSw_event_loop_15
   \   0000E7   A3           INC     DPTR
   \   0000E8   A3           INC     DPTR
   \   0000E9   A3           INC     DPTR
   \   0000EA   E0           MOVX    A,@DPTR
   \   0000EB   602C         JZ      ??zclSampleSw_event_loop_15
   \   0000ED   90....       MOV     DPTR,#zclSampleSw_DstAddr + 8
   \   0000F0   7402         MOV     A,#0x2
   \   0000F2   F0           MOVX    @DPTR,A
   \   0000F3   8A82         MOV     DPL,R2
   \   0000F5   8B83         MOV     DPH,R3
   \   0000F7   A3           INC     DPTR
   \   0000F8   E0           MOVX    A,@DPTR
   \   0000F9   F8           MOV     R0,A
   \   0000FA   A3           INC     DPTR
   \   0000FB   E0           MOVX    A,@DPTR
   \   0000FC   F9           MOV     R1,A
   \   0000FD   90....       MOV     DPTR,#zclSampleSw_DstAddr
   \   000100   E8           MOV     A,R0
   \   000101   F0           MOVX    @DPTR,A
   \   000102   A3           INC     DPTR
   \   000103   E9           MOV     A,R1
   \   000104   F0           MOVX    @DPTR,A
   \   000105   8A82         MOV     DPL,R2
   \   000107   8B83         MOV     DPH,R3
   \   000109   A3           INC     DPTR
   \   00010A   A3           INC     DPTR
   \   00010B   A3           INC     DPTR
   \   00010C   A3           INC     DPTR
   \   00010D   E0           MOVX    A,@DPTR
   \   00010E   90....       MOV     DPTR,#zclSampleSw_DstAddr + 9
   \   000111   F0           MOVX    @DPTR,A
   \   000112                ; Setup parameters for call to function HalLedSet
   \   000112   7A01         MOV     R2,#0x1
   \   000114   7908         MOV     R1,#0x8
   \   000116   12....       LCALL   ??HalLedSet?relay
   \                     ??zclSampleSw_event_loop_15:
   \   000119                ; Setup parameters for call to function osal_mem_free
   \   000119   AA..         MOV     R2,?V0 + 2
   \   00011B   AB..         MOV     R3,?V0 + 3
   \   00011D   8089         SJMP    ??zclSampleSw_event_loop_12
   \                     ??zclSampleSw_event_loop_14:
   \   00011F   EE           MOV     A,R6
   \   000120   2413         ADD     A,#0x13
   \   000122   F582         MOV     DPL,A
   \   000124   EF           MOV     A,R7
   \   000125   3400         ADDC    A,#0x0
   \   000127   F583         MOV     DPH,A
   \   000129   E0           MOVX    A,@DPTR
   \   00012A   F8           MOV     R0,A
   \   00012B   A3           INC     DPTR
   \   00012C   E0           MOVX    A,@DPTR
   \   00012D   F583         MOV     DPH,A
   \   00012F   8882         MOV     DPL,R0
   \   000131   E0           MOVX    A,@DPTR
   \   000132   700A         JNZ     ??zclSampleSw_event_loop_16
   \   000134                ; Setup parameters for call to function HalLedSet
   \   000134   7A01         MOV     R2,#0x1
   \                     ??zclSampleSw_event_loop_17:
   \   000136   7908         MOV     R1,#0x8
   \   000138   12....       LCALL   ??HalLedSet?relay
   \   00013B   02....       LJMP    ??zclSampleSw_event_loop_4 & 0xFFFF
   \                     ??zclSampleSw_event_loop_16:
   \   00013E                ; Setup parameters for call to function HalLedSet
   \   00013E   7A04         MOV     R2,#0x4
   \   000140   80F4         SJMP    ??zclSampleSw_event_loop_17
   \                     ??zclSampleSw_event_loop_5:
   \   000142   AA..         MOV     R2,?V0 + 0
   \   000144   E5..         MOV     A,?V0 + 1
   \   000146   6480         XRL     A,#0x80
   \   000148   FB           MOV     R3,A
   \   000149   8004         SJMP    ??zclSampleSw_event_loop_2
    247          
    248            // Discard unknown events
    249            return 0;
   \                     ??zclSampleSw_event_loop_1:
   \   00014B   7A00         MOV     R2,#0x0
   \   00014D   7B00         MOV     R3,#0x0
   \                     ??zclSampleSw_event_loop_2:
   \   00014F   7F06         MOV     R7,#0x6
   \   000151   02....       LJMP    ?BANKED_LEAVE_XDATA
    250          }

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine2:
   \   000000   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_5:
   \   000003   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine3:
   \   000000   EE           MOV     A,R6
   \   000001   2417         ADD     A,#0x17
   \   000003   F582         MOV     DPL,A
   \   000005   EF           MOV     A,R7
   \   000006   3400         ADDC    A,#0x0
   \   000008   F583         MOV     DPH,A
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   22           RET

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine1:
   \   000000   12....       LCALL   ?Subroutine3 & 0xFFFF
   \                     ??CrossCallReturnLabel_4:
   \   000003   F8           MOV     R0,A
   \   000004   A3           INC     DPTR
   \   000005   E0           MOVX    A,@DPTR
   \   000006   F9           MOV     R1,A
   \   000007   8882         MOV     DPL,R0
   \   000009   8983         MOV     DPH,R1
   \   00000B   7900         MOV     R1,#0x0
   \   00000D   22           RET
    251          
    252          
    253          /*********************************************************************
    254           * @fn      zclSampleSw_ProcessZDOMsgs()
    255           *
    256           * @brief   Process response messages
    257           *
    258           * @param   none
    259           *
    260           * @return  none
    261           */
    262          void zclSampleSw_ProcessZDOMsgs( zdoIncomingMsg_t *inMsg )
    263          {
    264            switch ( inMsg->clusterID )
    265            {
    266              case End_Device_Bind_rsp:
    267                if ( ZDO_ParseBindRsp( inMsg ) == ZSuccess )
    268                {
    269                  // Light LED
    270                  HalLedSet( HAL_LED_4, HAL_LED_MODE_ON );
    271                }
    272          #if defined(BLINK_LEDS)
    273                else
    274                {
    275                  // Flash LED to show failure
    276                  HalLedSet ( HAL_LED_4, HAL_LED_MODE_FLASH );
    277                }
    278          #endif
    279                break;
    280          
    281              case Match_Desc_rsp:
    282                {
    283                  ZDO_ActiveEndpointRsp_t *pRsp = ZDO_ParseEPListRsp( inMsg );
    284                  if ( pRsp )
    285                  {
    286                    if ( pRsp->status == ZSuccess && pRsp->cnt )
    287                    {
    288                      zclSampleSw_DstAddr.addrMode = (afAddrMode_t)Addr16Bit;
    289                      zclSampleSw_DstAddr.addr.shortAddr = pRsp->nwkAddr;
    290                      // Take the first endpoint, Can be changed to search through endpoints
    291                      zclSampleSw_DstAddr.endPoint = pRsp->epList[0];
    292          
    293                      // Light LED
    294                      HalLedSet( HAL_LED_4, HAL_LED_MODE_ON );
    295                    }
    296                    osal_mem_free( pRsp );
    297                  }
    298                }
    299                break;
    300            }
    301          }
    302          
    303          /*********************************************************************
    304           * @fn      zclSampleSw_HandleKeys
    305           *
    306           * @brief   Handles all key events for this device.
    307           *
    308           * @param   shift - true if in shift/alt.
    309           * @param   keys - bit field for key events. Valid entries:
    310           *                 HAL_KEY_SW_4
    311           *                 HAL_KEY_SW_3
    312           *                 HAL_KEY_SW_2
    313           *                 HAL_KEY_SW_1
    314           *
    315           * @return  none
    316           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    317          static void zclSampleSw_HandleKeys( byte shift, byte keys )
   \                     zclSampleSw_HandleKeys:
    318          {
   \   000000   74F6         MOV     A,#-0xa
   \   000002   12....       LCALL   ?BANKED_ENTER_XDATA
   \   000005                ; Saved register size: 10
   \   000005                ; Auto size: 9
   \   000005   74F7         MOV     A,#-0x9
   \   000007   12....       LCALL   ?ALLOC_XSTACK8
   \   00000A   EA           MOV     A,R2
   \   00000B   FF           MOV     R7,A
    319            zAddrType_t dstAddr;
    320            (void)shift;  // Intentionally unreferenced parameter
    321          
    322            if ( keys & HAL_KEY_SW_1 )
   \   00000C   A2E0         MOV     C,0xE0 /* A   */.0
   \   00000E   5045         JNC     ??zclSampleSw_HandleKeys_0
    323            {
    324              // Using this as the "Light Switch"
    325          #ifdef ZCL_ON_OFF
    326              zclGeneral_SendOnOff_CmdToggle( SAMPLESW_ENDPOINT, &zclSampleSw_DstAddr, false, 0 );
   \   000010                ; Setup parameters for call to function zcl_SendCommand
   \   000010   E4           CLR     A
   \   000011   F5..         MOV     ?V0 + 0,A
   \   000013   F5..         MOV     ?V0 + 1,A
   \   000015   78..         MOV     R0,#?V0 + 0
   \   000017   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001A   78..         MOV     R0,#?V0 + 0
   \   00001C   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00001F   78..         MOV     R0,#?V0 + 0
   \   000021   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000024   78..         MOV     R0,#?V0 + 0
   \   000026   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000029   78..         MOV     R0,#?V0 + 0
   \   00002B   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00002E   78..         MOV     R0,#?V0 + 0
   \   000030   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000033   75..01       MOV     ?V0 + 0,#0x1
   \   000036   78..         MOV     R0,#?V0 + 0
   \   000038   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00003B   75..02       MOV     ?V0 + 0,#0x2
   \   00003E   78..         MOV     R0,#?V0 + 0
   \   000040   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   000043   7C06         MOV     R4,#0x6
   \   000045   7D00         MOV     R5,#0x0
   \   000047   7A..         MOV     R2,#zclSampleSw_DstAddr & 0xff
   \   000049   7B..         MOV     R3,#(zclSampleSw_DstAddr >> 8) & 0xff
   \   00004B   790C         MOV     R1,#0xc
   \   00004D   12....       LCALL   ??zcl_SendCommand?relay
   \   000050   740B         MOV     A,#0xb
   \   000052   12....       LCALL   ?DEALLOC_XSTACK8
    327          #endif
    328            }
    329          
    330            if ( keys & HAL_KEY_SW_2 )
   \                     ??zclSampleSw_HandleKeys_0:
   \   000055   EF           MOV     A,R7
   \   000056   A2E1         MOV     C,0xE0 /* A   */.1
   \   000058   5069         JNC     ??zclSampleSw_HandleKeys_1
    331            {
    332              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF );
   \   00005A                ; Setup parameters for call to function HalLedSet
   \   00005A   7A00         MOV     R2,#0x0
   \   00005C   7908         MOV     R1,#0x8
   \   00005E   12....       LCALL   ??HalLedSet?relay
    333          
    334              // Initiate an End Device Bind Request, this bind request will
    335              // only use a cluster list that is important to binding.
    336              dstAddr.addrMode = afAddr16Bit;
   \   000061   7408         MOV     A,#0x8
   \   000063   12....       LCALL   ?XSTACK_DISP0_8
   \   000066   7402         MOV     A,#0x2
   \   000068   F0           MOVX    @DPTR,A
    337              dstAddr.addr.shortAddr = 0;   // Coordinator makes the match
   \   000069   85..82       MOV     DPL,?XSP + 0
   \   00006C   85..83       MOV     DPH,?XSP + 1
   \   00006F   E4           CLR     A
   \   000070   F0           MOVX    @DPTR,A
   \   000071   A3           INC     DPTR
   \   000072   F0           MOVX    @DPTR,A
    338              ZDP_EndDeviceBindReq( &dstAddr, NLME_GetShortAddr(),
    339                                     SAMPLESW_ENDPOINT,
    340                                     ZCL_HA_PROFILE_ID,
    341                                     0, NULL,   // No incoming clusters to bind
    342                                     ZCLSAMPLESW_BINDINGLIST, bindingOutClusters,
    343                                     TRUE );
   \   000073                ; Setup parameters for call to function ZDP_EndDeviceBindReq
   \   000073   75..01       MOV     ?V0 + 0,#0x1
   \   000076   78..         MOV     R0,#?V0 + 0
   \   000078   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00007B   75....       MOV     ?V0 + 0,#bindingOutClusters & 0xff
   \   00007E   75....       MOV     ?V0 + 1,#(bindingOutClusters >> 8) & 0xff
   \   000081   78..         MOV     R0,#?V0 + 0
   \   000083   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000086   75..01       MOV     ?V0 + 0,#0x1
   \   000089   78..         MOV     R0,#?V0 + 0
   \   00008B   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00008E   E4           CLR     A
   \   00008F   F5..         MOV     ?V0 + 0,A
   \   000091   F5..         MOV     ?V0 + 1,A
   \   000093   78..         MOV     R0,#?V0 + 0
   \   000095   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000098   78..         MOV     R0,#?V0 + 0
   \   00009A   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   00009D   75..04       MOV     ?V0 + 0,#0x4
   \   0000A0   75..01       MOV     ?V0 + 1,#0x1
   \   0000A3   78..         MOV     R0,#?V0 + 0
   \   0000A5   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000A8                ; Setup parameters for call to function NLME_GetShortAddr
   \   0000A8   12....       LCALL   ??NLME_GetShortAddr?relay
   \   0000AB   EA           MOV     A,R2
   \   0000AC   FC           MOV     R4,A
   \   0000AD   EB           MOV     A,R3
   \   0000AE   FD           MOV     R5,A
   \   0000AF   740C         MOV     A,#0xc
   \   0000B1   F9           MOV     R1,A
   \   0000B2   7409         MOV     A,#0x9
   \   0000B4   12....       LCALL   ?XSTACK_DISP0_8
   \   0000B7   AA82         MOV     R2,DPL
   \   0000B9   AB83         MOV     R3,DPH
   \   0000BB   12....       LCALL   ??ZDP_EndDeviceBindReq?relay
   \   0000BE   7409         MOV     A,#0x9
   \   0000C0   12....       LCALL   ?DEALLOC_XSTACK8
    344            }
    345          
    346            if ( keys & HAL_KEY_SW_3 )
    347            {
    348            }
    349          
    350            if ( keys & HAL_KEY_SW_4 )
   \                     ??zclSampleSw_HandleKeys_1:
   \   0000C3   EF           MOV     A,R7
   \   0000C4   A2E3         MOV     C,0xE0 /* A   */.3
   \   0000C6   505C         JNC     ??zclSampleSw_HandleKeys_2
    351            {
    352              HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF );
   \   0000C8                ; Setup parameters for call to function HalLedSet
   \   0000C8   7A00         MOV     R2,#0x0
   \   0000CA   7908         MOV     R1,#0x8
   \   0000CC   12....       LCALL   ??HalLedSet?relay
    353          
    354              // Initiate a Match Description Request (Service Discovery)
    355              dstAddr.addrMode = AddrBroadcast;
   \   0000CF   7408         MOV     A,#0x8
   \   0000D1   12....       LCALL   ?XSTACK_DISP0_8
   \   0000D4   740F         MOV     A,#0xf
   \   0000D6   F0           MOVX    @DPTR,A
    356              dstAddr.addr.shortAddr = NWK_BROADCAST_SHORTADDR;
   \   0000D7   85..82       MOV     DPL,?XSP + 0
   \   0000DA   85..83       MOV     DPH,?XSP + 1
   \   0000DD   74FF         MOV     A,#-0x1
   \   0000DF   F0           MOVX    @DPTR,A
   \   0000E0   A3           INC     DPTR
   \   0000E1   F0           MOVX    @DPTR,A
    357              ZDP_MatchDescReq( &dstAddr, NWK_BROADCAST_SHORTADDR,
    358                                 ZCL_HA_PROFILE_ID,
    359                                 ZCLSAMPLESW_BINDINGLIST, bindingOutClusters,
    360                                 0, NULL,   // No incoming clusters to bind
    361                                 FALSE );
   \   0000E2                ; Setup parameters for call to function ZDP_MatchDescReq
   \   0000E2   75..00       MOV     ?V0 + 0,#0x0
   \   0000E5   78..         MOV     R0,#?V0 + 0
   \   0000E7   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000EA   E4           CLR     A
   \   0000EB   F5..         MOV     ?V0 + 1,A
   \   0000ED   78..         MOV     R0,#?V0 + 0
   \   0000EF   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   0000F2   78..         MOV     R0,#?V0 + 0
   \   0000F4   12....       LCALL   ?PUSH_XSTACK_I_ONE
   \   0000F7   75....       MOV     ?V0 + 0,#bindingOutClusters & 0xff
   \   0000FA   75....       MOV     ?V0 + 1,#(bindingOutClusters >> 8) & 0xff
   \   0000FD   78..         MOV     R0,#?V0 + 0
   \   0000FF   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   000102   75..04       MOV     ?V0 + 0,#0x4
   \   000105   75..01       MOV     ?V0 + 1,#0x1
   \   000108   78..         MOV     R0,#?V0 + 0
   \   00010A   12....       LCALL   ?PUSH_XSTACK_I_TWO
   \   00010D   7901         MOV     R1,#0x1
   \   00010F   7CFF         MOV     R4,#-0x1
   \   000111   7DFF         MOV     R5,#-0x1
   \   000113   7408         MOV     A,#0x8
   \   000115   12....       LCALL   ?XSTACK_DISP0_8
   \   000118   AA82         MOV     R2,DPL
   \   00011A   AB83         MOV     R3,DPH
   \   00011C   12....       LCALL   ??ZDP_MatchDescReq?relay
   \   00011F   7408         MOV     A,#0x8
   \   000121   12....       LCALL   ?DEALLOC_XSTACK8
    362            }
    363          }
   \                     ??zclSampleSw_HandleKeys_2:
   \   000124   7409         MOV     A,#0x9
   \   000126   12....       LCALL   ?DEALLOC_XSTACK8
   \   000129   7F02         MOV     R7,#0x2
   \   00012B   02....       LJMP    ?BANKED_LEAVE_XDATA
    364          
    365          /*********************************************************************
    366           * @fn      zclSampleSw_ProcessIdentifyTimeChange
    367           *
    368           * @brief   Called to process any change to the IdentifyTime attribute.
    369           *
    370           * @param   none
    371           *
    372           * @return  none
    373           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    374          static void zclSampleSw_ProcessIdentifyTimeChange( void )
   \                     zclSampleSw_ProcessIdentifyTimeChange:
    375          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    376            if ( zclSampleSw_IdentifyTime > 0 )
   \   000004   90....       MOV     DPTR,#zclSampleSw_IdentifyTime
   \   000007   E0           MOVX    A,@DPTR
   \   000008   F8           MOV     R0,A
   \   000009   A3           INC     DPTR
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   F9           MOV     R1,A
   \   00000C   E8           MOV     A,R0
   \   00000D   49           ORL     A,R1
   \   00000E   601F         JZ      ??zclSampleSw_ProcessIdentifyTimeChange_0
    377            {
    378              osal_start_timerEx( zclSampleSw_TaskID, SAMPLESW_IDENTIFY_TIMEOUT_EVT, 1000 );
   \   000010                ; Setup parameters for call to function osal_start_timerEx
   \   000010   7CE8         MOV     R4,#-0x18
   \   000012   7D03         MOV     R5,#0x3
   \   000014   7A01         MOV     R2,#0x1
   \   000016   7B00         MOV     R3,#0x0
   \   000018   90....       MOV     DPTR,#zclSampleSw_TaskID
   \   00001B   E0           MOVX    A,@DPTR
   \   00001C   F9           MOV     R1,A
   \   00001D   12....       LCALL   ??osal_start_timerEx?relay
    379              HalLedBlink ( HAL_LED_4, 0xFF, HAL_LED_DEFAULT_DUTY_CYCLE, HAL_LED_DEFAULT_FLASH_TIME );
   \   000020                ; Setup parameters for call to function HalLedBlink
   \   000020   7CE8         MOV     R4,#-0x18
   \   000022   7D03         MOV     R5,#0x3
   \   000024   7B05         MOV     R3,#0x5
   \   000026   7AFF         MOV     R2,#-0x1
   \   000028   7908         MOV     R1,#0x8
   \   00002A   12....       LCALL   ??HalLedBlink?relay
   \   00002D   801D         SJMP    ??zclSampleSw_ProcessIdentifyTimeChange_1
    380            }
    381            else
    382            {
    383              if ( zclSampleSw_OnOff )
   \                     ??zclSampleSw_ProcessIdentifyTimeChange_0:
   \   00002F   90....       MOV     DPTR,#zclSampleSw_OnOff
   \   000032   E0           MOVX    A,@DPTR
   \   000033   6004         JZ      ??zclSampleSw_ProcessIdentifyTimeChange_2
    384                HalLedSet ( HAL_LED_4, HAL_LED_MODE_ON );
   \   000035                ; Setup parameters for call to function HalLedSet
   \   000035   7A01         MOV     R2,#0x1
   \   000037   8002         SJMP    ??zclSampleSw_ProcessIdentifyTimeChange_3
    385              else
    386                HalLedSet ( HAL_LED_4, HAL_LED_MODE_OFF );
   \                     ??zclSampleSw_ProcessIdentifyTimeChange_2:
   \   000039                ; Setup parameters for call to function HalLedSet
   \   000039   7A00         MOV     R2,#0x0
   \                     ??zclSampleSw_ProcessIdentifyTimeChange_3:
   \   00003B   7908         MOV     R1,#0x8
   \   00003D   12....       LCALL   ??HalLedSet?relay
    387              osal_stop_timerEx( zclSampleSw_TaskID, SAMPLESW_IDENTIFY_TIMEOUT_EVT );
   \   000040                ; Setup parameters for call to function osal_stop_timerEx
   \   000040   7A01         MOV     R2,#0x1
   \   000042   7B00         MOV     R3,#0x0
   \   000044   90....       MOV     DPTR,#zclSampleSw_TaskID
   \   000047   E0           MOVX    A,@DPTR
   \   000048   F9           MOV     R1,A
   \   000049   12....       LCALL   ??osal_stop_timerEx?relay
    388            }
    389          }
   \                     ??zclSampleSw_ProcessIdentifyTimeChange_1:
   \   00004C                REQUIRE ?Subroutine0
   \   00004C                ; // Fall through to label ?Subroutine0

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
   \                     ?Subroutine0:
   \   000000   D083         POP     DPH
   \   000002   D082         POP     DPL
   \   000004   02....       LJMP    ?BRET
    390          
    391          /*********************************************************************
    392           * @fn      zclSampleSw_BasicResetCB
    393           *
    394           * @brief   Callback from the ZCL General Cluster Library
    395           *          to set all the Basic Cluster attributes to  default values.
    396           *
    397           * @param   none
    398           *
    399           * @return  none
    400           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    401          static void zclSampleSw_BasicResetCB( void )
   \                     zclSampleSw_BasicResetCB:
    402          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    403          }
   \   000000   02....       LJMP    ?BRET
    404          
    405          /*********************************************************************
    406           * @fn      zclSampleSw_IdentifyCB
    407           *
    408           * @brief   Callback from the ZCL General Cluster Library when
    409           *          it received an Identity Command for this application.
    410           *
    411           * @param   srcAddr - source address and endpoint of the response message
    412           * @param   identifyTime - the number of seconds to identify yourself
    413           *
    414           * @return  none
    415           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    416          static void zclSampleSw_IdentifyCB( zclIdentify_t *pCmd )
   \                     zclSampleSw_IdentifyCB:
    417          {
   \   000000   C082         PUSH    DPL
   \   000002   C083         PUSH    DPH
   \   000004                ; Saved register size: 2
   \   000004                ; Auto size: 0
    418            zclSampleSw_IdentifyTime = pCmd->identifyTime;
   \   000004   8A82         MOV     DPL,R2
   \   000006   8B83         MOV     DPH,R3
   \   000008   A3           INC     DPTR
   \   000009   A3           INC     DPTR
   \   00000A   E0           MOVX    A,@DPTR
   \   00000B   F8           MOV     R0,A
   \   00000C   A3           INC     DPTR
   \   00000D   E0           MOVX    A,@DPTR
   \   00000E   F9           MOV     R1,A
   \   00000F   90....       MOV     DPTR,#zclSampleSw_IdentifyTime
   \   000012   E8           MOV     A,R0
   \   000013   F0           MOVX    @DPTR,A
   \   000014   A3           INC     DPTR
   \   000015   E9           MOV     A,R1
   \   000016   F0           MOVX    @DPTR,A
    419            zclSampleSw_ProcessIdentifyTimeChange();
   \   000017                ; Setup parameters for call to function zclSampleSw_ProcessIdentifyTimeChange
   \   000017   12....       LCALL   ??zclSampleSw_ProcessIdentifyTimeChange?relay
    420          }
   \   00001A   80..         SJMP    ?Subroutine0
    421          
    422          /*********************************************************************
    423           * @fn      zclSampleSw_IdentifyQueryRspCB
    424           *
    425           * @brief   Callback from the ZCL General Cluster Library when
    426           *          it received an Identity Query Response Command for this application.
    427           *
    428           * @param   srcAddr - source address
    429           * @param   timeout - number of seconds to identify yourself (valid for query response)
    430           *
    431           * @return  none
    432           */

   \                                 In  segment BANKED_CODE, align 1, keep-with-next
    433          static void zclSampleSw_IdentifyQueryRspCB(  zclIdentifyQueryRsp_t *pRsp )
   \                     zclSampleSw_IdentifyQueryRspCB:
    434          {
   \   000000                ; Saved register size: 0
   \   000000                ; Auto size: 0
    435            // Query Response (with timeout value)
    436            (void)pRsp;
    437          }
   \   000000   02....       LJMP    ?BRET

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for bindingOutClusters>`:
   \   000000   0600         DW 6

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for sampleSw_TestEp>`:
   \   000000   14           DB 20
   \   000001   ....         DW zclSampleSw_TaskID
   \   000003   0000         DW 0H
   \   000005   00           DB 0

   \                                 In  segment XDATA_ID, align 1, keep-with-next
   \                     `?<Initializer for zclSampleSw_CmdCallbacks>`:
   \   000000   ....         DW ??zclSampleSw_BasicResetCB?relay
   \   000002   ....         DW ??zclSampleSw_IdentifyCB?relay
   \   000004   ....         DW ??zclSampleSw_IdentifyQueryRspCB?relay
   \   000006   0000         DW 0H
   \   000008   0000         DW 0H
   \   00000A   0000         DW 0H
   \   00000C   0000         DW 0H
   \   00000E   0000         DW 0H
   \   000010   0000         DW 0H
   \   000012   0000         DW 0H
   \   000014   0000         DW 0H
   \   000016   0000         DW 0H
   \   000018   0000         DW 0H
   \   00001A   0000         DW 0H
   \   00001C   0000         DB 0, 0

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclSampleSw_Init?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_Init

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclSampleSw_event_loop?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_event_loop

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclSampleSw_HandleKeys?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_HandleKeys

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclSampleSw_ProcessIdentifyTimeChange?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_ProcessIdentifyTimeChange

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclSampleSw_BasicResetCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_BasicResetCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclSampleSw_IdentifyCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_IdentifyCB

   \                                 In  segment BANK_RELAYS, align 1
   \                     ??zclSampleSw_IdentifyQueryRspCB?relay:
   \   000000   12....       LCALL   ?BDISPATCH
   \   000003   ......       DC24    zclSampleSw_IdentifyQueryRspCB
    438          
    439          /******************************************************************************
    440           *
    441           *  Functions for processing ZCL Foundation incoming Command/Response messages
    442           *
    443           *****************************************************************************/
    444          
    445          /*********************************************************************
    446           * @fn      zclSampleSw_ProcessIncomingMsg
    447           *
    448           * @brief   Process ZCL Foundation incoming message
    449           *
    450           * @param   pInMsg - pointer to the received message
    451           *
    452           * @return  none
    453           */
    454          static void zclSampleSw_ProcessIncomingMsg( zclIncomingMsg_t *pInMsg )
    455          {
    456            switch ( pInMsg->zclHdr.commandID )
    457            {
    458          #ifdef ZCL_READ
    459              case ZCL_CMD_READ_RSP:
    460                zclSampleSw_ProcessInReadRspCmd( pInMsg );
    461                break;
    462          #endif
    463          #ifdef ZCL_WRITE
    464              case ZCL_CMD_WRITE_RSP:
    465                zclSampleSw_ProcessInWriteRspCmd( pInMsg );
    466                break;
    467          #endif
    468          #ifdef ZCL_REPORT
    469              // See ZCL Test Applicaiton (zcl_testapp.c) for sample code on Attribute Reporting
    470              case ZCL_CMD_CONFIG_REPORT:
    471                //zclSampleSw_ProcessInConfigReportCmd( pInMsg );
    472                break;
    473          
    474              case ZCL_CMD_CONFIG_REPORT_RSP:
    475                //zclSampleSw_ProcessInConfigReportRspCmd( pInMsg );
    476                break;
    477          
    478              case ZCL_CMD_READ_REPORT_CFG:
    479                //zclSampleSw_ProcessInReadReportCfgCmd( pInMsg );
    480                break;
    481          
    482              case ZCL_CMD_READ_REPORT_CFG_RSP:
    483                //zclSampleSw_ProcessInReadReportCfgRspCmd( pInMsg );
    484                break;
    485          
    486              case ZCL_CMD_REPORT:
    487                //zclSampleSw_ProcessInReportCmd( pInMsg );
    488                break;
    489          #endif
    490              case ZCL_CMD_DEFAULT_RSP:
    491                zclSampleSw_ProcessInDefaultRspCmd( pInMsg );
    492                break;
    493          #ifdef ZCL_DISCOVER
    494              case ZCL_CMD_DISCOVER_RSP:
    495                zclSampleSw_ProcessInDiscRspCmd( pInMsg );
    496                break;
    497          #endif
    498              default:
    499                break;
    500            }
    501          
    502            if ( pInMsg->attrCmd )
    503              osal_mem_free( pInMsg->attrCmd );
    504          }
    505          
    506          #ifdef ZCL_READ
    507          /*********************************************************************
    508           * @fn      zclSampleSw_ProcessInReadRspCmd
    509           *
    510           * @brief   Process the "Profile" Read Response Command
    511           *
    512           * @param   pInMsg - incoming message to process
    513           *
    514           * @return  none
    515           */
    516          static uint8 zclSampleSw_ProcessInReadRspCmd( zclIncomingMsg_t *pInMsg )
    517          {
    518            zclReadRspCmd_t *readRspCmd;
    519            uint8 i;
    520          
    521            readRspCmd = (zclReadRspCmd_t *)pInMsg->attrCmd;
    522            for (i = 0; i < readRspCmd->numAttr; i++)
    523            {
    524              // Notify the originator of the results of the original read attributes
    525              // attempt and, for each successfull request, the value of the requested
    526              // attribute
    527            }
    528          
    529            return TRUE;
    530          }
    531          #endif // ZCL_READ
    532          
    533          #ifdef ZCL_WRITE
    534          /*********************************************************************
    535           * @fn      zclSampleSw_ProcessInWriteRspCmd
    536           *
    537           * @brief   Process the "Profile" Write Response Command
    538           *
    539           * @param   pInMsg - incoming message to process
    540           *
    541           * @return  none
    542           */
    543          static uint8 zclSampleSw_ProcessInWriteRspCmd( zclIncomingMsg_t *pInMsg )
    544          {
    545            zclWriteRspCmd_t *writeRspCmd;
    546            uint8 i;
    547          
    548            writeRspCmd = (zclWriteRspCmd_t *)pInMsg->attrCmd;
    549            for (i = 0; i < writeRspCmd->numAttr; i++)
    550            {
    551              // Notify the device of the results of the its original write attributes
    552              // command.
    553            }
    554          
    555            return TRUE;
    556          }
    557          #endif // ZCL_WRITE
    558          
    559          /*********************************************************************
    560           * @fn      zclSampleSw_ProcessInDefaultRspCmd
    561           *
    562           * @brief   Process the "Profile" Default Response Command
    563           *
    564           * @param   pInMsg - incoming message to process
    565           *
    566           * @return  none
    567           */
    568          static uint8 zclSampleSw_ProcessInDefaultRspCmd( zclIncomingMsg_t *pInMsg )
    569          {
    570            // zclDefaultRspCmd_t *defaultRspCmd = (zclDefaultRspCmd_t *)pInMsg->attrCmd;
    571            // Device is notified of the Default Response command.
    572            (void)pInMsg;
    573            return TRUE;
    574          }
    575          
    576          #ifdef ZCL_DISCOVER
    577          /*********************************************************************
    578           * @fn      zclSampleSw_ProcessInDiscRspCmd
    579           *
    580           * @brief   Process the "Profile" Discover Response Command
    581           *
    582           * @param   pInMsg - incoming message to process
    583           *
    584           * @return  none
    585           */
    586          static uint8 zclSampleSw_ProcessInDiscRspCmd( zclIncomingMsg_t *pInMsg )
    587          {
    588            zclDiscoverRspCmd_t *discoverRspCmd;
    589            uint8 i;
    590          
    591            discoverRspCmd = (zclDiscoverRspCmd_t *)pInMsg->attrCmd;
    592            for ( i = 0; i < discoverRspCmd->numAttr; i++ )
    593            {
    594              // Device is notified of the result of its attribute discovery command.
    595            }
    596          
    597            return TRUE;
    598          }
    599          #endif // ZCL_DISCOVER
    600          
    601          
    602          /****************************************************************************
    603          ****************************************************************************/
    604          
    605          

   Maximum stack usage in bytes:

     Function                       ISTACK PSTACK XSTACK
     --------                       ------ ------ ------
     zclSampleSw_BasicResetCB           0      0      0
     zclSampleSw_HandleKeys             0      0     44
       -> zcl_SendCommand               0      0     60
       -> HalLedSet                     0      0     38
       -> NLME_GetShortAddr             0      0     56
       -> ZDP_EndDeviceBindReq          0      0     56
       -> HalLedSet                     0      0     38
       -> ZDP_MatchDescReq              0      0     54
     zclSampleSw_IdentifyCB             2      0      0
       -> zclSampleSw_ProcessIdentifyTimeChange
                                        4      0      0
     zclSampleSw_IdentifyQueryRspCB     0      0      0
     zclSampleSw_Init                   0      0      9
       -> zclHA_Init                    0      0     18
       -> zclGeneral_RegisterCmdCallbacks
                                        0      0     18
       -> zcl_registerAttrList          0      0     18
       -> zcl_registerForMsg            0      0     18
       -> RegisterForKeys               0      0     18
       -> afRegister                    0      0     18
       -> ZDO_RegisterForZDOMsg         0      0     18
       -> ZDO_RegisterForZDOMsg         0      0     18
     zclSampleSw_ProcessIdentifyTimeChange
                                        2      0     14
       -> osal_start_timerEx            4      0      0
       -> HalLedBlink                   4      0      0
       -> HalLedSet                     4      0      0
       -> HalLedSet                     4      0      0
       -> osal_stop_timerEx             4      0      0
     zclSampleSw_event_loop             0      0     14
       -> zclSampleSw_ProcessIdentifyTimeChange
                                        0      0     28
       -> zclSampleSw_HandleKeys        0      0     28
       -> osal_msg_deallocate           0      0     28
       -> osal_msg_receive              0      0     28
       -> osal_mem_free                 0      0     28
       -> ZDO_ParseEPListRsp            0      0     28
       -> HalLedSet                     0      0     28
       -> osal_mem_free                 0      0     28
       -> HalLedSet                     0      0     28
       -> HalLedSet                     0      0     28


   Segment part sizes:

     Function/Label                                Bytes
     --------------                                -----
     zclSampleSw_TaskID                               1
     zclSampleSw_DstAddr                             12
     bindingOutClusters                               2
     sampleSw_TestEp                                  6
     zclSampleSw_CmdCallbacks                        30
     zclSampleSw_Init                               102
     zclSampleSw_event_loop                         340
     ?Subroutine2                                     4
     ?Subroutine3                                    12
     ?Subroutine1                                    14
     zclSampleSw_HandleKeys                         302
     zclSampleSw_ProcessIdentifyTimeChange
                                                     76
     ?Subroutine0                                     7
     zclSampleSw_BasicResetCB                         3
     zclSampleSw_IdentifyCB                          28
     zclSampleSw_IdentifyQueryRspCB                   3
     ?<Initializer for bindingOutClusters>            2
     ?<Initializer for sampleSw_TestEp>               6
     ?<Initializer for zclSampleSw_CmdCallbacks>     30
     ??zclSampleSw_Init?relay                         6
     ??zclSampleSw_event_loop?relay                   6
     ??zclSampleSw_HandleKeys?relay                   6
     ??zclSampleSw_ProcessIdentifyTimeChange?relay    6
     ??zclSampleSw_BasicResetCB?relay                 6
     ??zclSampleSw_IdentifyCB?relay                   6
     ??zclSampleSw_IdentifyQueryRspCB?relay           6

 
 891 bytes in segment BANKED_CODE
  42 bytes in segment BANK_RELAYS
  38 bytes in segment XDATA_I
  38 bytes in segment XDATA_ID
  13 bytes in segment XDATA_Z
 
 971 bytes of CODE  memory
  51 bytes of XDATA memory

Errors: none
Warnings: none
